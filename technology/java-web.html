
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Java Web Technologies - KnowledgeShop</title>
  <meta name="author" content="Mohamed Fizal Ihsan Mohamed">


<meta name="description" content="Java Web Technologies Servlets Servlet Life Cycle Servlet Key/Value Stores ServletConfig ServletContext HttpRequest HttpSession Listeners Redirect &hellip;">
<meta name="keywords" content="big data, data science, mongodb, nosql, R, statistics">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://fizalihsan.github.io/technology/java-web.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <!-- Below custom CSS is for table border styling -->
  <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />

  <link href="/atom.xml" rel="alternate" title="KnowledgeShop" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
jax: ["input/TeX", "output/HTML-CSS"],
tex2jax: {
  inlineMath: [ ['$', '$'], ["\\(","\\)"] ],
  displayMath: [ ['$$', '$$'], ["\\[","\\]"] ],
  processEscapes: true,
  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
},
messageStyle: "none",
"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>

<script src="/mathjax/unpacked/MathJax.js"></script>

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">KnowledgeShop</a></h1>
  
    <h2>Learn & Share</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>


</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">Java Web Technologies</h1>
    
  </header>
  
  <p><ul>
 <li><a href="#Servlets">Servlets</a>
 <ul>
  <li><a href="#Servlet.Life.Cycle">Servlet Life Cycle</a></li>
  <li><a href="#Servlet.Key.Value.Stores">Servlet Key/Value Stores</a>
  <ul>
   <li><a href="#ServletConfig">ServletConfig</a></li>
   <li><a href="#ServletContext">ServletContext</a></li>
   <li><a href="#HttpRequest">HttpRequest</a></li>
   <li><a href="#HttpSession">HttpSession</a></li>
  </ul>
  </li>
  <li><a href="#Listeners">Listeners</a></li>
  <li><a href="#Redirect.Vs.Forwarding...Request.Dispatch">Redirect Vs Forwarding / Request Dispatch</a>
  <ul>
   <li><a href="#Request.Redirect">Request Redirect</a></li>
   <li><a href="#Request.Forwarding...Request.Dispatch">Request Forwarding / Request Dispatch</a></li>
  </ul>
  </li>
  <li><a href="#Deployment.Descriptor..web.xml.">Deployment Descriptor (web.xml)</a></li>
  <li><a href="#Servlet.chaining...inter-servlet.communication">Servlet chaining / inter-servlet communication</a></li>
 </ul>
 </li>
 <li><a href="#JSP">JSP</a>
 <ul>
  <li><a href="#EL.-.Expression.Language">EL - Expression Language</a></li>
  <li><a href="#Lifecycle.methods.of.JSP">Lifecycle methods of JSP</a></li>
  <li><a href="#Custom.Tags">Custom Tags</a>
  <ul>
   <li><a href="#Include.directive">Include directive</a></li>
   <li><a href="#Include.Action">Include Action</a></li>
  </ul>
  </li>
  <li><a href="#Custom.tag.libs">Custom tag libs</a></li>
  <li><a href="#Filters">Filters</a></li>
  <li><a href="#Wrappers">Wrappers</a></li>
 </ul>
 </li>
 <li><a href="#Spring.MVC">Spring MVC</a>
 <ul>
  <li><a href="#MVC.Model.1..amp..2">MVC Model 1 &amp; 2</a></li>
  <li><a href="#Web.MVC.Application.Layer">Web MVC Application Layer</a>
  <ul>
   <li><a href="#User.Interface..Presentation.">User Interface (Presentation)</a></li>
   <li><a href="#Web..Presentation.">Web (Presentation)</a></li>
   <li><a href="#Service.layer">Service layer</a></li>
   <li><a href="#Data.Access">Data Access</a></li>
   <li><a href="#Domain">Domain</a></li>
  </ul>
  </li>
  <li><a href="#Definitions">Definitions</a>
  <ul>
   <li><a href="#ModelMap">ModelMap</a></li>
   <li><a href="#View">View</a></li>
   <li><a href="#ModelAndView">ModelAndView</a></li>
   <li><a href="#Controller">Controller</a>
   <ul>
    <li><a href="#FormController">FormController</a></li>
    <li><a href="#MultiActionController">MultiActionController</a></li>
   </ul>
   </li>
   <li><a href="#HandlerMapping">HandlerMapping</a></li>
   <li><a href="#HandlerInterceptor">HandlerInterceptor</a></li>
   <li><a href="#HandlerExecutionChain">HandlerExecutionChain</a></li>
   <li><a href="#HandlerAdapter">HandlerAdapter</a></li>
   <li><a href="#Resolvers">Resolvers</a>
   <ul>
    <li><a href="#ViewResolver">ViewResolver</a></li>
    <li><a href="#HandlerExceptionResolver">HandlerExceptionResolver</a>
</li>
   </ul>
   </li>
  </ul>
  </li>
  <li><a href="#DispatcherServlet.Bootstrapping">DispatcherServlet Bootstrapping</a>
  <ul>
   <li><a href="#How.to.configure.DispatcherServlet.and.ContextLoaderListener.in.Java.">How to configure DispatcherServlet and ContextLoaderListener in Java?</a></li>
   <li><a href="#DispatcherServlet.Request.Processing.Flow">DispatcherServlet Request Processing Flow</a>
</li>
  </ul>
  </li>
 </ul>
 </li>
 <li><a href="#FAQs">FAQs</a></li>
 <li><a href="#Bibliography">Bibliography</a></li>
</ul>

</p>

<a name="Servlets"></a>
<h1>Servlets</h1>

<p><img class="right" src="/technology/servlet-class-diagram.png"></p>

<a name="Servlet.Life.Cycle"></a>
<h2>Servlet Life Cycle</h2>

<ul>
<li>Load the servlet class</li>
<li><code>GenericServlet.init()</code> - invoked only once in servlet&rsquo;s lifecycle</li>
<li><code>GenericServlet.service()</code> - for each request, this method is invoked in a separate thread</li>
<li><code>GenericServlet.destroy()</code> - invoked only once in servlet&rsquo;s lifecycle</li>
</ul>


<a name="Servlet.Key.Value.Stores"></a>
<h2>Servlet Key/Value Stores</h2>

<a name="ServletConfig"></a>
<h3>ServletConfig</h3>

<ul>
<li>used to access deploy-time configurations from web.xml.</li>
<li>1 per servlet.</li>
<li>Key and value should be strings</li>
<li>How to access: <code>this.getServletConfig();</code></li>
</ul>


<figure class='code'><figcaption><span>Servlet Config</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;web-app&gt;</span>
</span><span class='line'>   <span class="nt">&lt;servlet&gt;</span>
</span><span class='line'>       ...
</span><span class='line'>       <span class="nt">&lt;init-param&gt;</span>
</span><span class='line'>          <span class="nt">&lt;param-name&gt;</span>key<span class="nt">&lt;/param-name&gt;</span>
</span><span class='line'>          <span class="nt">&lt;param-value&gt;</span>value<span class="nt">&lt;/param-value&gt;</span>
</span><span class='line'>       <span class="nt">&lt;/init-param&gt;</span>
</span><span class='line'>   <span class="nt">&lt;/servlet&gt;</span>
</span><span class='line'><span class="nt">&lt;/web-app&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<a name="ServletContext"></a>
<h3>ServletContext</h3>

<ul>
<li>used to access deploy-time configurations from web.xml</li>
<li>1 per web app</li>
<li>Key and value should be strings</li>
<li>How to access: <code>this.getServletConfig().getServletContext();</code></li>
</ul>


<figure class='code'><figcaption><span>Servlet Context</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;web-app&gt;</span>
</span><span class='line'>   <span class="nt">&lt;servlet&gt;</span>
</span><span class='line'>       ...
</span><span class='line'>   <span class="nt">&lt;/servlet&gt;</span>
</span><span class='line'>
</span><span class='line'>   <span class="nt">&lt;context-param&gt;</span>
</span><span class='line'>      <span class="nt">&lt;param-name&gt;</span>key<span class="nt">&lt;/param-name&gt;</span>
</span><span class='line'>      <span class="nt">&lt;param-value&gt;</span>value<span class="nt">&lt;/param-value&gt;</span>
</span><span class='line'>   <span class="nt">&lt;/context-param&gt;</span>
</span><span class='line'><span class="nt">&lt;/web-app&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<a name="HttpRequest"></a>
<h3>HttpRequest</h3>

<ul>
<li>Parameters (thread-safe)

<ul>
<li>set by client request.</li>
<li>servlet can set new parameters</li>
</ul>
</li>
<li>Attributes (thread-safe)

<ul>
<li>used by servlet to set additional key-value pairs before forwarding the request.</li>
</ul>
</li>
</ul>


<a name="HttpSession"></a>
<h3>HttpSession</h3>

<ul>
<li>Parameters</li>
<li>Attributes</li>
<li>sessionId is set by the servlet on cookie in a response</li>
</ul>


<a name="Listeners"></a>
<h2>Listeners</h2>

<ul>
<li><code>ServletContextListener</code> - callback interface that is invoked after the ServletContext is initialized.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;listener&gt;</span>
</span><span class='line'>     <span class="nt">&lt;listener-class&gt;</span>com.test.Foo<span class="nt">&lt;listener-class&gt;</span>
</span><span class='line'><span class="nt">&lt;/listener&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><code>ServletContextAttributeListener</code></li>
<li><code>ServletRequestAttributeListener</code></li>
<li><code>HttpSessionListener</code></li>
<li><code>HttpSessionBindingListener</code></li>
<li><code>HttpSessionActivationListener</code></li>
</ul>


<a name="Redirect.Vs.Forwarding...Request.Dispatch"></a>
<h2>Redirect Vs Forwarding / Request Dispatch</h2>

<a name="Request.Redirect"></a>
<h3>Request Redirect</h3>

<ul>
<li>client requests url1 to server -> server redirects to a new url -> request makes a round trip back to client -> browser sends a new request to the new url</li>
<li>url in the client browser is changed to the new url</li>
<li>redirect is visible to the client</li>
</ul>


<a name="Request.Forwarding...Request.Dispatch"></a>
<h3>Request Forwarding / Request Dispatch</h3>

<ul>
<li>client request url1 to server -> server redirects to a new url directly without round trip</li>
<li>url in the client browser is not changed</li>
<li>redirect is not visible to the client</li>
</ul>


<a name="Deployment.Descriptor..web.xml."></a>
<h2>Deployment Descriptor (web.xml)</h2>

<p>3 names of a servlet</p>

<ul>
<li>File path name: path to an actual class file. e.g., /classes/registration/SignUpServlet.class</li>
<li>Deployment name: a logical internal name that doesn&rsquo;t have to be the same as the class name. e.g., EnrollServlet</li>
<li>Public URL name: the name the client knows about from HTML link.</li>
</ul>


<figure class='code'><figcaption><span>web.xml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'> <span class="nt">&lt;servlet&gt;</span>
</span><span class='line'> <span class="c">&lt;!-- end user nevers sees the 2 names below --&gt;</span>
</span><span class='line'> <span class="nt">&lt;servlet-name&gt;</span>Internal Name<span class="nt">&lt;/servlet-name&gt;</span>
</span><span class='line'> <span class="nt">&lt;servlet-class&gt;</span>com.mfi.Servlet1<span class="nt">&lt;/servlet-class&gt;</span>
</span><span class='line'> <span class="c">&lt;!-- loads and initializes the servlet when the server starts. If multiple servlets are configured, they are loaded as per the number priority number provided --&gt;</span>
</span><span class='line'> <span class="nt">&lt;load-on-startup&gt;</span>1<span class="nt">&lt;/load-on-startup&gt;</span>
</span><span class='line'> <span class="nt">&lt;/servlet&gt;</span>
</span><span class='line'>
</span><span class='line'> <span class="nt">&lt;servlet-mapping&gt;</span>
</span><span class='line'> <span class="nt">&lt;servlet-name&gt;</span>Internal Name<span class="nt">&lt;/servlet-name&gt;</span>
</span><span class='line'> <span class="c">&lt;!-- this is the name the client sees.--&gt;</span>
</span><span class='line'> <span class="nt">&lt;url-pattern&gt;</span>/public1<span class="nt">&lt;/url-pattern&gt;</span>
</span><span class='line'> <span class="nt">&lt;/servlet-mapping&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Servlet.chaining...inter-servlet.communication"></a>
<h2>Servlet chaining / inter-servlet communication</h2>

<p>Calling another servlet from inside a servlet. Achieved by using RequestDispatcher.forward(req, res) and RequestDispatcher.include(req, res).</p>

<a name="JSP"></a>
<h1>JSP</h1>

<p>JSP</p>

<ul>
<li>Scriplets - <code>&lt;% %&gt;</code>. <code>&lt;% out.println("Hello"); %&gt;</code></li>
<li>Expressions - <code>&lt;%= %&gt;</code> - no semicolons needed. <code>&lt;%= Counter.getCount()%&gt;</code></li>
<li>Comments

<ul>
<li><code>&lt;%-- JSP comment: visible only to developer --%&gt;</code></li>
<li><code>&lt;!-- HTML comment: visible to client --&gt;</code></li>
</ul>
</li>
<li>Declarations - <code>&lt;%! %&gt;</code> - to declare methods and instance variables</li>
<li>Directives

<ul>
<li>Directives give special instructions to the container on page translation time.</li>
<li>Types

<ul>
<li>page directives - <code>&lt;%@ page import="java.util.Date, java.util.List" %&gt;</code></li>
<li>include directives - To include external JSP/HTML files into another JSP. <code>&lt;%@ include file="x.html" %&gt;</code></li>
<li>taglib directives - to include custom tag libraries. <code>&lt;%@ taglib tagdir="/WEB-INF/lib" prefix="c" %&gt;</code></li>
</ul>
</li>
</ul>
</li>
<li>Implicit Objects

<ul>
<li><code>out - JspWriter</code></li>
<li><code>request - HttpServletRequest</code></li>
<li><code>response - HttpServletResponse</code></li>
<li><code>session - HttpSession</code></li>
<li><code>application - ServletContext</code></li>
<li><code>config - ServletConfig</code></li>
<li><code>exception - JspException</code></li>
<li><code>pageContext - PageContext</code></li>
<li><code>page - Object</code></li>
</ul>
</li>
<li>Scopes

<ul>
<li><code>app</code> - application</li>
<li><code>request</code> - request</li>
<li><code>session</code> - session</li>
<li><code>page</code> - pageContext</li>
</ul>
</li>
</ul>


<a name="EL.-.Expression.Language"></a>
<h2>EL - Expression Language</h2>

<ul>
<li>EL was introduced non-Java web developers</li>
<li><code>${applicationScope.mail}</code> is equivalent to <code>&lt;%= application.getAttribute("mail")%&gt;</code></li>
<li>To enable or disable scripting. <code>&lt;scripting-invalid&gt;true/false&lt;/scripting-invalid&gt;</code> in web.xml</li>
<li>To enable or disable EL. <code>&lt;el-ignored&gt;true/false&lt;/el-ignored&gt;</code> in web.xml or using page directive <code>&lt;%@ page isELIgnore="true" %&gt;</code></li>
</ul>


<a name="Lifecycle.methods.of.JSP"></a>
<h2>Lifecycle methods of JSP</h2>

<ul>
<li>JSP page (extends) <code>javax.servlet.jsp.HttpJspPage</code> extends <code>javax.servlet.jsp.JspPage</code> extends <code>javax.servlet.Servlet</code></li>
<li>The generated servlet class thus implements all the methods of these three interfaces.</li>
<li>The <code>JspPage</code> interface declares only two methods - <code>jspInit()</code> and <code>jspDestroy()</code> that must be implemented by all JSP pages regardless of the client-server protocol. However the JSP specification has provided the <code>HttpJspPage</code> interface specifically for the JSP pages serving HTTP requests. This interface declares one method <code>_jspService()</code>.</li>
<li>The <code>jspInit()</code> - The container calls the jspInit() to initialize the servlet instance.It is called before any other method, and is called only once for a servlet instance.</li>
<li>The <code>_jspservice()</code> - The container calls the _jspservice() for each request, passing it the request and the response objects. Should not be overridden.</li>
<li>The <code>jspDestroy()</code> - The container calls this when it decides take the instance out of service. It is the last method called n the servlet instance.</li>
</ul>


<a name="Custom.Tags"></a>
<h2>Custom Tags</h2>

<p>Include Action Element - &lt;jsp:include page=&ldquo;x.html&rdquo; /></p>

<p>Difference between include directive and include custom tag?</p>

<a name="Include.directive"></a>
<h3>Include directive</h3>

<ul>
<li>At JSP page translation time, the content of the file given in the include directive is ‘pasted’ as it is, in the place where the JSP include directive is used. Then the source JSP page is converted into a java servlet class. The included file can be a static resource or a JSP page. Generally JSP include directive is used to include header banners and footers. The JSP compilation procedure is that, the source JSP page gets compiled only if that page has changed. If there is a change in the included JSP file, the source JSP file will not be compiled and therefore the modification will not get reflected in the output.</li>
<li>Only one servlet is executed at run time.</li>
<li>Scriptlet variables declared in the parent page can be accessed in the included page (remember, they are the same page).</li>
<li>The included page does not need to able to be compiled as a standalone JSP. It can be a code fragment or plain text. The included page will never be compiled as a standalone. The included page can also have any extension, though .jspf has become a conventionally used extension.</li>
<li>One drawback on older containers is that changes to the include pages may not take effect until the parent page is updated. Recent versions of Tomcat will check the include pages for updates and force a recompile of the parent if they&rsquo;re updated.</li>
</ul>


<a name="Include.Action"></a>
<h3>Include Action</h3>

<ul>
<li>The jsp:include action element is like a function call. At runtime, the included file will be ‘executed’ and the result content will be included with the soure JSP page. When the included JSP page is called, both the request and response objects are passed as parameters. If there is a need to pass additional parameters, then jsp:param element can be used. If the resource is static, its content is inserted into the calling JSP file, since there is no processing needed.</li>
<li>Each included page is executed as a separate servlet at run time.</li>
<li>Pages can conditionally be included at run time. This is often useful for templating frameworks that build pages out of includes. The parent page can determine which page, if any, to include according to some run-time condition.</li>
<li>The values of scriptlet variables need to be explicitly passed to the include page.</li>
<li>The included page must be able to be run on its own. Request.getSession() request.getSession(true) only creates a session if one does not exist. request.getSession(false) retrieves a session only if it already exists.</li>
</ul>


<a name="Custom.tag.libs"></a>
<h2>Custom tag libs</h2>

<ul>
<li>Your tag class should implement <code>Tag</code> interface or extend from <code>TagSupport</code> or <code>BodyTagSupport</code> class.</li>
<li>Implement <code>doStartTag()</code> method - If your tag does not have a body, then this method should return SKIP_BODY constant. Otherwise return EVAL_BODY_INCLUDE which in turn would call &lsquo;doEndTag()&rsquo; method.</li>
<li>To make use of what&rsquo;s inside the body of the tag, implement <code>doEndTag()</code>. After processing the body content, if you want to continue processing the rest of the page, return EVAL_PAGE, else SKIP_PAGE.</li>
<li>If your tag has an attribute &lsquo;attr1&rsquo;, then add the method <code>setAttr1()</code> to your tag class.</li>
<li>To evaluate the contents of the body, your class should extend from <code>BodyTagSupport</code> class, and override &lsquo;doAfterBody()&rsquo; method. This method normally returns SKIP_BODY meaning that no further body processing should be performed, else it returns EVAL_BODY_TAG to evaluate and handle the body again.</li>
</ul>


<a name="Filters"></a>
<h2>Filters</h2>

<ul>
<li>Filter - can intercept and process requests before and after servlet execution. e.g., of <strong>Intercepting Filter pattern</strong>. Filters can be chained.</li>
<li>Request Filters can

<ul>
<li>perform security checks</li>
<li>reformat request headers or bodies</li>
<li>audit or log requests</li>
</ul>
</li>
<li>Response Filters can

<ul>
<li>compress the response stream</li>
<li>append or alter the response</li>
<li>create a different response altogether</li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span>Filter interface</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Filter</span> <span class="o">{</span>
</span><span class='line'>   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="n">FilterConfig</span> <span class="n">config</span><span class="o">);</span>
</span><span class='line'>   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doFilter</span><span class="o">(</span><span class="n">ServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="n">ServletResponse</span> <span class="n">resp</span><span class="o">,</span> <span class="n">FilterChain</span> <span class="n">chain</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span><span class="o">;</span>
</span><span class='line'>   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">();</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Filter settings in web.xml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;filter&gt;</span>
</span><span class='line'>   <span class="nt">&lt;filter-name&gt;</span>FilterName<span class="nt">&lt;/filter-name&gt;</span>
</span><span class='line'>   <span class="nt">&lt;filter-class&gt;</span>com.test.Foo<span class="nt">&lt;filter-class&gt;</span>
</span><span class='line'>   <span class="nt">&lt;init-param&gt;</span>
</span><span class='line'>      <span class="nt">&lt;param-name&gt;</span>name<span class="nt">&lt;/param-name&gt;</span>
</span><span class='line'>      <span class="nt">&lt;param-value&gt;</span>value<span class="nt">&lt;/param-value&gt;</span>
</span><span class='line'>   <span class="nt">&lt;init-param&gt;</span>
</span><span class='line'><span class="nt">&lt;/filter&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;filter-mapping&gt;</span>
</span><span class='line'>   <span class="nt">&lt;filter-name&gt;</span>FilterName<span class="nt">&lt;/filter-name&gt;</span>
</span><span class='line'>   <span class="nt">&lt;servlet-name&gt;</span>YourServletName<span class="nt">&lt;servlet-name&gt;</span> or <span class="nt">&lt;url-mapping&gt;</span>/*.do<span class="nt">&lt;/url-mapping&gt;</span>
</span><span class='line'><span class="nt">&lt;/filter-mapping&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Starting Servlet 2.4 version, filters can be applied to request dispatchers - forwards and redirects.</li>
</ul>


<a name="Wrappers"></a>
<h2>Wrappers</h2>

<p>Wrapper classes in Servlet API</p>

<ul>
<li>ServletRequestWrapper</li>
<li>HttpServletRequestWrapper</li>
<li>ServletResponseWrapper</li>
<li>HttpServletResponseWrapper</li>
</ul>


<p>Whenever you want to create a custom request or response object, just subclass one of the convenience request or response &ldquo;wrapper&rdquo; classes</p>

<a name="Spring.MVC"></a>
<h1>Spring MVC</h1>

<p><img class="right" src="/technology/mvc-model.png"></p>

<a name="MVC.Model.1..amp..2"></a>
<h2>MVC Model 1 &amp; 2</h2>

<ul>
<li>Model 1 works well for GUI apps. Model 2 works well for web apps.</li>
<li>Front Controller is the extra thing in Model 2.</li>
<li>&ndash;(incoming request)&ndash;> Front Controller &ndash;(delegates request)&ndash;> Controller &ndash;(handles request, creates model)&ndash;> Front Controller &ndash;(model)&ndash;> View Template &ndash;(renders response, returns control)&ndash;> Front Controller &ndash;(returns response)&ndash;></li>
<li>Front Controller is implemented as

<ul>
<li><code>javax.servlet.Servlet</code></li>
<li><code>ActionServlet</code> in Struts</li>
<li><code>FacesServlet</code> in JSF</li>
<li><code>DispatcherServlet</code> in Spring MVC</li>
</ul>
</li>
</ul>


<a name="Web.MVC.Application.Layer"></a>
<h2>Web MVC Application Layer</h2>

<p>Layering leads to separation of concerns, easy testability, clean architecture.</p>

<a name="User.Interface..Presentation."></a>
<h3>User Interface (Presentation)</h3>

<ul>
<li>presents the application to the user rendering the response as requested by the client. e.g., HTML, XML, PDF, etc.</li>
<li>In Spring it is represented by a generic interface &lsquo;View&rsquo; and it has no dependencies on a particular view technology like JSP, Velocity, Tiles, etc.</li>
</ul>


<a name="Web..Presentation."></a>
<h3>Web (Presentation)</h3>

<ul>
<li>Thin layer; no business logic;</li>
<li>In Spring it is represented by &lsquo;Controller&rsquo; interface or classes with @Controller annotation.</li>
<li>Responsible for (1) page navigation logic via Spring Web Flow, etc. (2) integrating service layer and HTTP.</li>
<li>Converts HTTP request into service layer calls, and then transforms result from server into response for the user interface.</li>
<li>Contains cookies, HTTP headers, HTTP sessions; responsible to manage these consistently and transparently.</li>
<li>2 types of web layer implementations:

<ul>
<li>(a) request-repsonse frameworks. e.g., Struts and Spring MVC. They operate on ServletRequest and ServletResponse objects and is not hiddent from the users.</li>
<li>(b) component-based frameworks. e.g., JSF, Tapestry. Hides the Servlet API from the user and offers a component-based programming model.</li>
</ul>
</li>
</ul>


<a name="Service.layer"></a>
<h3>Service layer</h3>

<ul>
<li>only business logic (transactional boundary, security, etc.).</li>
<li>No persistence or presentation logic.</li>
<li>Coarse-API layer - funciton should represent a single unit of work that either succeeds of fails. User can user different clients (web, web service, desktop app, JMS) but the business logic is same.</li>
<li>Services should be stateless and a good practice to keep it Singleton.</li>
<li>Keeping the service layer clean also allows us to reuse the same services for different channels. For example, it enables us to add a web service or JMS-driven solution</li>
</ul>


<a name="Data.Access"></a>
<h3>Data Access</h3>

<p>Interface-based layer abstracts persistence framework (JDO, JDBC, JPA, etc.) No business logic.</p>

<a name="Domain"></a>
<h3>Domain</h3>

<p>(cuts across all layers) - Domain class names are nouns. Contains both state and behavior. In anemic domain model, it holds only state and no behavior.</p>

<p>Communication should be top-to-bottom except Domain layer. Data access shouldn&rsquo;t access Service layer. Circular dependencies is a sign of bad design. A rule of thumb is that, if a layer has too many dependencies with other layers, we might want to introduce another layer that incorporates all the dependencies. On the other hand, if we see a single layer throughout different layers, we might want to reconsider this layer and make it an aspect of the application (Spring AOP).</p>

<a name="Definitions"></a>
<h2>Definitions</h2>

<a name="ModelMap"></a>
<h3>ModelMap</h3>

<a name="View"></a>
<h3>View</h3>

<ul>
<li>Out-of-the-box - JSP, JSTL, Tiles, Velocity, FreeMaker, etc.</li>
<li>Special - redirect: and forward:</li>
</ul>


<a name="ModelAndView"></a>
<h3>ModelAndView</h3>

<p>An aggregator/container class which holds both a ModelMap and a View instance.</p>

<a name="Controller"></a>
<h3>Controller</h3>

<ul>
<li>RequestMapping is defined both at class-level and method-level</li>
<li>Types of mapping requests

<ul>
<li>by path - <code>@RequestMapping("/welcome")</code></li>
<li>by HTTP method - <code>@RequestMapping("/welcome", method=RequestMethod.GET)</code></li>
<li>by presence/value of query parameter - <code>@RequestMapping("find=ByMake", "form")</code></li>
<li>by presence/value of request header  - <code>@RequestMapping("/welcome", header="accept=text/*")</code></li>
</ul>
</li>
<li>Types of controller method return types (<a href="http://docs.spring.io/spring/docs/3.0.x/spring-framework-reference/html/mvc.html">http://docs.spring.io/spring/docs/3.0.x/spring-framework-reference/html/mvc.html</a>)

<ul>
<li>void</li>
<li>String</li>
<li>logical view name (&ldquo;car&rdquo;)</li>
<li>physical view name (<code>/WEB-INF/jsp/car.jsp</code>)</li>
<li>special view names (<code>redirect:/cars/7</code>)</li>
<li>ModelAndView</li>
<li>Model / Map / ModelMap</li>
<li>View</li>
<li><code>@ResponseBody</code> / <code>@ModelAttribute</code></li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span>Sample Controller </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ItemController</span> <span class="kd">implements</span> <span class="n">Controller</span> <span class="o">{</span>
</span><span class='line'><span class="o">...</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Sample Controller - Declarative Style</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="nd">@Controller</span>
</span><span class='line'> <span class="kd">public</span> <span class="kd">class</span> <span class="nc">ItemController</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>     <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">&quot;viewItem.htm&quot;</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
</span><span class='line'>     <span class="kd">public</span> <span class="n">Item</span> <span class="nf">viewItem</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="n">Long</span> <span class="n">id</span><span class="o">){</span>
</span><span class='line'>         <span class="k">return</span> <span class="n">itemservice</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
</span><span class='line'>     <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<ul>
<li>Additional annotations at controller level

<ul>
<li><code>@ModelAttribute</code>

<ul>
<li>method parameter level - maps a model attribute to the specific method parameter</li>
<li>method level - provides the reference data to the model</li>
</ul>
</li>
<li><code>@SessionAttributes</code> - class level: list the names or types of model attributes which should be stroed in the session.</li>
<li><code>@RequestHeader</code> - method parameter level - maps request header parameters to method parameters</li>
<li><code>@CookieValue</code> - method parameter level - gets the JSESSIONID of the cookie</li>
<li><code>@RequestBody</code> / <code>@ResponseBody</code></li>
</ul>
</li>
</ul>


<a name="FormController"></a>
<h4>FormController</h4>

<ul>
<li>Override onSubmit() method to provide custom handling function</li>
<li>Override formBackingObject() method to provide default values when the form is first rendered.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;bean</span> <span class="na">name=</span><span class="s">&quot;/foo.htm&quot;</span> <span class="na">class=</span><span class="s">&quot;com.FooFormController&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;commandName&quot;</span> <span class="na">value=</span><span class="s">&quot;...&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;commandClass&quot;</span> <span class="na">value=</span><span class="s">&quot;...&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;validator&quot;</span> <span class="na">value=</span><span class="s">&quot;com.FooValidator&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;successView&quot;</span> <span class="na">value=</span><span class="s">&quot;baz.html&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/bean&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Form Controller</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">class</span> <span class="nc">FooFormController</span> <span class="kd">extends</span> <span class="n">SimpleFormController</span><span class="o">{</span>
</span><span class='line'>    <span class="kt">void</span> <span class="nf">onSubmit</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">){</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">new</span> <span class="nf">ModelAndView</span><span class="o">(</span><span class="k">new</span> <span class="nf">RedirectView</span><span class="o">(</span><span class="n">getSuccessView</span><span class="o">())));</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">class</span> <span class="nc">FooValidator</span> <span class="kd">implements</span> <span class="n">Validator</span><span class="o">{</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<a name="MultiActionController"></a>
<h4>MultiActionController</h4>

<ul>
<li>allows multiple request types to be handled by the same class. For example, when mapped *Foo.htm to FooController which extends MultiActionController.</li>
<li>Based on the request type, different methods on implementing class will be invoked; which method to invoke is decided by MethodNameResolver implementation which can be injected.</li>
<li><code>InternalPathMethodNameResolver</code> - maps file name in url to method name. e.g, requesting addFoo.htm and deleteFoo.htm would invoke methods addFoo() and deleteFoo() respectively.</li>
<li><code>PropertiesMethodNameResolver</code> - maps url to method name based on a pre-configured map as follows.</li>
</ul>


<figure class='code'><figcaption><span>PropertiesMethodNameResolver </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.mvc.multiaction.PropertiesMethodNameResolver&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;mappings&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;value&gt;</span>
</span><span class='line'>         /multiaction/add.dev=add
</span><span class='line'>         /multiaction/remove.dev=remove
</span><span class='line'>         /multiaction/listAll.dev=listAll
</span><span class='line'>      <span class="nt">&lt;/value&gt;</span>
</span><span class='line'>   <span class="nt">&lt;/property&gt;</span>
</span><span class='line'><span class="nt">&lt;/bean&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><code>ParameterNameMethodNameResolver</code> - maps a request parameter value to method name. e.g., <code>/Foo.html?action=add</code> invokes method add() after configuring &lsquo;action&rsquo; as the parameter to look for.</li>
</ul>


<figure class='code'><figcaption><span>ParameterNameMethodNameResolver</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.mvc.multiaction.ParameterMethodNameResolver&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;paramName&quot;</span> <span class="na">value=</span><span class="s">&quot;action&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/bean&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<a name="HandlerMapping"></a>
<h3>HandlerMapping</h3>

<ul>
<li>Maps incoming request to a handler/controller</li>
<li>Default mapping classes

<ul>
<li><code>BeanNameUrlHandlerMapping</code> - maps url to bean name in app context xml.</li>
<li><code>DefaultAnnotationHandlerMapping</code> - maps url to classes with <code>@Controller</code> and <code>@RequestMapping</code> annotations.</li>
</ul>
</li>
<li><code>SimpleUrlHandlerMapping</code> - maps url to a bean name in the app context.</li>
</ul>


<a name="HandlerInterceptor"></a>
<h3>HandlerInterceptor</h3>

<ul>
<li>intercepting requests before handed over to handlers to implement special functions like security, monitoring, etc.</li>
<li>This interface defines three methods:

<ul>
<li><code>preHandle()</code> is called before the actual handler is executed;</li>
<li><code>postHandle()</code> - is called after the handler is executed;</li>
<li><code>afterProcessing()</code> - is called after the complete request has finished.</li>
</ul>
</li>
</ul>


<a name="HandlerExecutionChain"></a>
<h3>HandlerExecutionChain</h3>

<p>???</p>

<a name="HandlerAdapter"></a>
<h3>HandlerAdapter</h3>

<p>is the glue between the dispatcher servlet and the handler. It removes the actual execution logic from the dispatcher servlet, which makes the dispatcher servlet infinitely extensible. It executes the Handler identified from the HandlerMapping. It takes a Handler as input and returns ModelAndView. If there is no view in the returned ModelAndView, RequestToViewNameTranslator is consulted to generate a view name based on the incoming request.</p>

<a name="Resolvers"></a>
<h3>Resolvers</h3>

<a name="ViewResolver"></a>
<h4>ViewResolver</h4>

<p>UrlBasedViewResolver - controller returns &ldquo;cars&rdquo;, resolver resolves it to &ldquo;/WEB-INF/jsp/cars.jsp&rdquo;</p>

<figure class='code'><figcaption><span>UrlBasedViewResolver</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;viewResolver&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework....UrlBasedViewResolver&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;viewClass&quot;</span> <span class="na">value=</span><span class="s">&quot;org.springframework...JstlView&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;prefix&quot;</span> <span class="na">value=</span><span class="s">&quot;/WEB-INF/jsp&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;suffix&quot;</span> <span class="na">value=</span><span class="s">&quot;.jsp&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/bean&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<a name="HandlerExceptionResolver"></a>
<h4>HandlerExceptionResolver</h4>

<a name="DispatcherServlet.Bootstrapping"></a>
<h2>DispatcherServlet Bootstrapping</h2>

<p>4 ways to bootstrap a DispatcherServlet in a ServletContainer like Tomcat</p>

<ol>
<li><code>web.xml</code></li>
<li><code>web-fragment.xml</code> (since Servlet 3.0 spec)</li>
<li><code>javax.servlet.ServletContextInitializer</code> (since Servlet 3.0 spec)</li>
</ol>


<figure class='code'><figcaption><span>ServletContainerInitializer </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BookstoreServletContainerInitializer</span> <span class="kd">implements</span> <span class="n">ServletContainerInitializer</span> <span class="o">{</span>
</span><span class='line'>   <span class="nd">@Override</span>
</span><span class='line'>   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onStartup</span><span class="o">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Class</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">classes</span><span class="o">,</span> <span class="n">ServletContext</span> <span class="n">servletContext</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">ServletRegistration</span><span class="o">.</span><span class="na">Dynamic</span> <span class="n">registration</span> <span class="o">=</span> <span class="n">servletContext</span><span class="o">.</span><span class="na">addServlet</span><span class="o">(</span><span class="s">&quot;dispatcher&quot;</span><span class="o">,</span> <span class="n">DispatcherServlet</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span><span class='line'>      <span class="n">registration</span><span class="o">.</span><span class="na">setLoadOnStartup</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span><span class='line'>      <span class="n">registration</span><span class="o">.</span><span class="na">addMapping</span><span class="o">(</span><span class="s">&quot;/*&quot;</span><span class="o">);</span>
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>Spring&rsquo;s WebApplicationInitializer</li>
</ol>


<p>Spring has an in-built implementation of ServletContextInitializer which scans classpath for WebApplicationInitializer implementations and invokes <code>onStartup()</code> on them.</p>

<figure class='code'><figcaption><span>WebApplicationInitializer</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BookstoreWebApplicationInitializer</span> <span class="kd">implements</span> <span class="n">WebApplicationInitializer</span> <span class="o">{}</span>
</span><span class='line'>   <span class="nd">@Override</span>
</span><span class='line'>   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onStartup</span><span class="o">(</span><span class="n">ServletContext</span> <span class="n">servletContext</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">ServletRegistration</span><span class="o">.</span><span class="na">Dynamic</span> <span class="n">registration</span> <span class="o">=</span> <span class="n">servletContext</span><span class="o">.</span><span class="na">addServlet</span><span class="o">(</span><span class="s">&quot;dispatcher&quot;</span><span class="o">,</span> <span class="n">DispatcherServlet</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span><span class='line'>      <span class="n">registration</span><span class="o">.</span><span class="na">addMapping</span><span class="o">(</span><span class="s">&quot;/*&quot;</span><span class="o">);</span>
</span><span class='line'>      <span class="n">registration</span><span class="o">.</span><span class="na">setLoadOnStartup</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>By default, the dispatcher servlet loads a file named [servletname]-servlet.xml from the WEB-INF directory.</p>

<a name="How.to.configure.DispatcherServlet.and.ContextLoaderListener.in.Java."></a>
<h3>How to configure DispatcherServlet and ContextLoaderListener in Java?</h3>

<p>In web, DispatcherServlet and ContextLoaderListener components bootstrap and configure an application context.</p>

<ul>
<li>Steps to create <code>DispatcherServlet</code> in Java

<ul>
<li>Spring 3.0 container automatically detects a FooWebAppInitializer class that extends WebApplicationInitializer.</li>
<li>FooWebAppInitializer overrides onStartUp(ServletContext) method.</li>
<li>Create new WebApplicationContext - new AnnotationConfigWebApplicationContext();</li>
<li>Create new DispatcherServlet - new DispatcherServlet(webappContext);</li>
<li>Add dispatcher servlet to ServletContext - servletContext.addServlet(&ldquo;dispatcher&rdquo;, dispatcherServlet);</li>
</ul>
</li>
<li>Steps to create <code>ContextLoaderListener</code> in Java

<ul>
<li>Spring 3.0 container automatically detects a FooWebAppInitializer class that extends WebApplicationInitializer.</li>
<li>FooWebAppInitializer overrides onStartUp(ServletContext) method.</li>
<li>Create new WebApplicationContext - new AnnotationConfigWebApplicationContext();</li>
<li>Create new ContextLoaderListener - new ContextLoaderListener(webappContext);</li>
<li>Add listener to ServletContext - servletContext.addListener(contextLoaderListener);</li>
</ul>
</li>
</ul>


<a name="DispatcherServlet.Request.Processing.Flow"></a>
<h3>DispatcherServlet Request Processing Flow</h3>

<p><img class="right" src="/technology/springmvc-flow.png"></p>

<ul>
<li>DispatcherServlet receives request.</li>
<li>Before dispatching

<ul>
<li>Determines and exposes java.util.Locale of the current request using LocaleResolver.</li>
<li>Prepares and exposes current request in RequestContextHolder.</li>
<li>Constructs FlashMap using FlashMapManager. Map contains attributes from previous request when a redirect is made.</li>
<li>Request is checked if it is a multipart HTTP request. If so, request is wrapped in MultipartHttpServletRequest via MultipartResolver.</li>
</ul>
</li>
<li>Dispatching

<ul>
<li>DispatcherServlet consults 1 or more HandlerMapping implementations to determine the handler to handle the request.</li>
<li>Check HandlerMapping

<ul>
<li>If found, HandlerMapping returns an HandlerExecutionChain which holds references to Handler and HandlerInterceptor<a href="optional"></a>.</li>
<li>If no handler found, http 404 response is sent.</li>
</ul>
</li>
<li>Check HandlerApapter

<ul>
<li>Servlet tries to find a HandlerAdapter,</li>
<li>If not found, ServletException is thrown.</li>
<li>If found and if 1 or more HandlerInterceptor are defined, preHandle and postHandle methods in the interceptor are executed before and after the Handler execution.</li>
<li>If a view is selected, DispatcherServlet checks if the view reference is a String or View.

<ul>
<li>If a String is found, ViewResolvers are consulted to resolve it to a View implementation.</li>
<li>If not resolved, ServletException is thrown.</li>
</ul>
</li>
</ul>
</li>
<li>Handling Exceptions

<ul>
<li>If an exception is thrown during request handling, DispatcherServlet consults HandlerExceptionResolver to handle thrown exceptions.</li>
<li>It resolves an exception to a view to show to the user.</li>
<li>If an exception is unresolved, it is rethrown and handled by the servlet container which throws HTTP 500 error.</li>
</ul>
</li>
</ul>
</li>
<li>After dispatching

<ul>
<li>DispatcherServlet uses the event mechanism in the Spring Framework to fire a RequestHandledEvent. ApplicationListener can be to receive and log these events.</li>
</ul>
</li>
</ul>


<a name="FAQs"></a>
<h1>FAQs</h1>

<ul>
<li>Servlets

<ul>
<li>Why is http stateless protocol? HttpServletRequest &amp; HttpServletResponse? HttpSession? GET is idempotent, but POST is not.</li>
<li>What is a cookie? Is there any security breach involved cos of using cookies?</li>
</ul>
</li>
</ul>


<a name="Bibliography"></a>
<h1>Bibliography</h1>

<ul>
<li>Pro Spring MVC with WebFlows</li>
</ul>


  
    <footer>
      
      
        <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://fizalihsan.github.io/technology/java-web.html" data-via="" data-counturl="http://fizalihsan.github.io/technology/java-web.html" >Tweet</a>
  
  
  
</div>

      
    </footer>
  
</article>

</div>

<aside class="sidebar">
  
    <section>

	<br/><br/>
	<ul>
		<h2>Technical</h2>

		<li>
			<h3>Architecture</h3>
			<a href="/technology/architecture/architecture.html">Overview</a>  |  <a href="/technology/architecture/coding-principles.html">Coding Principles</a>  |  <a href="/technology/architecture/design-principles.html">Design Principles</a>  |  <a href="/technology/architecture/logging-and-monitoring.html">Logging &amp; Monitoring</a>  |  <a href="/technology/architecture/patterns.html">Patterns</a>  |  <a href="/technology/transaction.html">Transactions</a>
		</li>

		<li>
			<h3>Database</h3>
			<a href="/technology/bigdata.html">Big Data</a>  |  <a href="/technology/nosql.html">NoSQL</a>  |  <a href="/technology/rdbms.html">RDBMS</a>  |  <a href="/technology/rdbms-products.html">RDBMS Products</a>
		</li>

		<li>
			<h3>Java</h3>
			<a href="/technology/java.html">Core Concepts</a>  |  <a href="/technology/java-collections.html">Collections</a>  |  <a href="/technology/java-concurrency.html">Concurrency</a>  |  <a href="/technology/java-database.html">Database</a>  |  <a href="/technology/java-jmx.html">JMX</a>  |  <a href="/technology/java-io.html">JNDI</a>  |  <a href="/technology/java-io.html">I/O</a>  |  <a href="/technology/java-performance.html">Performance</a>  |  <a href="/technology/spring.html">Spring</a>  |  <a href="/technology/java-testing.html">Testing</a>  |  <a href="/technology/java-web.html">Web</a>  |  <a href="/technology/java-newsletters.html">Java Specialist Newsletters</a>
		</li>

		<li>
			<h3>Languages</h3>
			<a href="/technology/groovy.html">Groovy</a>  |  <a href="/technology/scala.html">Scala</a>
		</li>

		<li>
			<h3>SOA</h3>
			<a href="/technology/soa.html">SOA Concepts</a>  |  <a href="/technology/messaging.html">Messaging</a>  |  <a href="/technology/webservices.html">Web Services</a>
		</li>

		<li>
			<h3>General Concepts</h3>
			<a href="/technology/datastructures.html">Data Structures</a>  |  <a href="/technology/oops.html">OOPS</a>  |  <a href="/technology/os.html">Operating Systems</a>  |  <a href="/technology/security.html">Security</a>  |  <a href="/technology/vcs.html">VCS</a>  |  <a href="/technology/webprogramming/webconcepts.html">Web Concepts</a>  |  <a href="/technology/xml.html">XML</a>  |  <a href="/technology/coding_bibliography.html">Coding Bibliography</a>
		</li>

		<h2>Non-Techninal</h2>

		<li>
			<h3>Data Science</h3>

			<a href="/datascience/datascience.html">Overview</a>  |  <a href="/datascience/statistics.html">Statistics</a>  |  <a href="/datascience/r.html">R</a>
		</li>

		<li>
			<h3>Domain Knowledge</h3>
			<a href="/domain/retirement.html">Retirement</a>
		</li>

		<li>
			<h3>Soft Skills</h3>
			<a href="/softskills/presentation.html">Presentation</a>  |  <a href="/softskills/productivity.html">Productivity</a>  |  <a href="/softskills/written.html">Written Communication</a>
		</li>
	</ul>

  <!-- <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
  </ul> &#8211;>
  <!-- <ul>
    <li><a href="/datascience/statistics.html">Statistics</a></li>
    <li><a href="/datascience/r.html">R Programming</a></li>
  </ul> &#8211;>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Mohamed Fizal Ihsan Mohamed -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
